#!/bin/bash

if [ "$1" = "--help" ]; then
  echo "usage: newcpp <name> [--here]"
  exit 0
fi

name="$1"
mode="$2"

if [ -z "$name" ]; then
  echo "usage: newcpp <name> [--here]"
  exit 1
fi

if [ "$mode" = "--here" ]; then
  dir="$(pwd)"
else
  dir="$(pwd)/$name"
  mkdir -p "$dir"
fi

mkdir -p "$dir/src"
mkdir -p "$dir/build"

cat > "$dir/src/main.cpp" <<EOF
#include <iostream>
using namespace std;

int main() {
    cout << "Hello" << endl;
    return 0;
}
EOF

cat > "$dir/CMakeLists.txt" <<EOF
cmake_minimum_required(VERSION 3.10)
project($name)
set(CMAKE_CXX_STANDARD 20)
add_executable($name src/main.cpp)
EOF

cd "$dir/build"
cmake ..

echo "Created project at $dir"
